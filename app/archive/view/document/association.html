{include file="../app/public/common_header.html"}
<style type="text/css">
    #Text1 {
        width: 87px;
        height: 20px;
    }
    #TextAnchorName {
        width: 100px;
    }
</style>
<body>
    <object id="RealBimOcx" classid="CLSID:2CD7E1BE-10B8-4A1C-B908-4FB7D4FD4ABD"  width="100%" height="90%"></object>

    <script type="text/javascript">

        var operateType = "";
        var base64PicData = "";
        var base64RenData = "";
        var text_sub = "";

        function FT1_onclick() {
            // 点击快照对应模型视图对应的位置
            RealBimOcx.ShowSnapshotOrMarkerInMem(base64RenData);
        }

        RealBimOcx.CreateMarkerBeginWithData(base64RenData);// 进入标注编辑状态

        function FT2_onclick() {
            text_sub += "321";
            RealBimOcx.SubmitMarkerText(text_sub);  //实施改变标注文字
        }

        function FT3_onclick() {
            RealBimOcx.CreateMarkerEndInMem(true, 0, 0, true, true);  //保存标注
        }

    </script>

    <script language="javascript"  for="RealBimOcx" EVENT="OnCurSelModelChanged(strObjName, uObjSubID, fObjSelX, fObjSelY, fObjSelZ, fObjBVMinX,fObjBVMinY,fObjBVMinZ, fObjBVMaxX,fObjBVMaxY,fObjBVMaxZ)" type="text/javascript">





        // //设置模型的可见性，0为不可见，1为可见。通过模型id进行关联。
        // RealBimOcx.SetHugeObjSubValidStateBegin();
        // RealBimOcx.SetHugeObjSubValidStateInfo(uObjSubID, 0);
        // RealBimOcx.SetHugeObjSubValidStateEnd();


        //获取一个构件的可见性状态
        //ULONG uObjSubID:构件ID
        //返回值表示指定构件的有效性:(0表示构件无效，1表示构件有效）
        // ULONG GetAHugeObjSubValidState(ULONG uObjSubID);



        //进入闪烁构件的设置状态
        //FlickerSwitchTimes:闪烁次数
        //FlickerInterval：闪烁时间间隔
        //Alpha0，AlphaAmp0，RGBBlendInfo0，Alpha1，AlphaAmp1，RGBBlendInfo1：两种闪烁状态的透明度，透明度混合系数，以及颜色和颜色混合系数，与AddSubClrInfo()的后三个参数用法相同
        // void SetSubObjFlickerBegin(LONG FlickerSwitchTimes,LONG FlickerInterval, BYTE Alpha0, BYTE AlphaAmp0, ULONG RGBBlendInfo0, BYTE Alpha1, BYTE AlphaAmp1, ULONG RGBBlendInfo1);

        // RealBimOcx.SetSubObjFlickerBegin(20,1000,255,255,0xff87ceeb,255,255,0x8000008b);
        // RealBimOcx.AddFlickerSubObjects(uObjSubID);
        // RealBimOcx.SetSubObjFlickerEnd();




        // 设置透明度和颜色：0为全透明，1为不透明
        // RealBimOcx.BatchAddSubClrInfoBegin();
        // RealBimOcx.AddSubClrPercent(uObjSubID,1,0xff87ceeb);
        // RealBimOcx.BatchAddSubClrInfoEnd();



        //设置最佳视角
        // RealBimOcx.SetSuitableCam();











    </script>

    <script type="text/javascript">

    </script>


    <script for="RealBimOcx" event="UIClicked(eType,uButtonMode)" language='javascript'>

        // function clearOperate() {
        // operateType = "";
        // RealBimOcx.AddAnchorEnd();
        // RealBimOcx.CreateMarkerEnd("", 0, 0, "", true);
        // };
        //
        // switch (eType) {
        //
        // //添加锚点
        // case "ADD_ANCHOR":
        //
        // clearOperate();
        //
        // RealBimOcx.AddAnchorBegin(0);//构件锚点开始
        //
        //
        // break;
        //
        // //显示锚点
        // case "DISP_ANCHOR":
        // // $.ajax({
        // //     type: "Get",
        // //     url: "/Anchor/GetAnchorsByUser",
        // //     success: function (data) {
        // //         data = data.result.anchors;
        // //         if (uButtonMode == 1) {
        // //             RealBimOcx.AddAnchorBegin(0);
        // //             $.each(data, function (i, item) {
        // //                 RealBimOcx.AddAnchor(item.name, item.xValue, item.yValue, item.zValue, 0);
        // //             })
        // //             RealBimOcx.AddAnchorEnd();
        // //         }
        // //         else {
        // //             RealBimOcx.DelAnchorBegin();
        // //             $.each(data, function (i, item) {
        // //                 var name = "1"
        // //                 RealBimOcx.DeleteAnchor(item.name);
        // //             })
        // //             RealBimOcx.DelAnchorEnd();
        // //         }
        // //     }
        // // });
        // break;
        //
        // case "DISP_TAG":
        // // $.ajax({
        // //     type: "Get",
        // //     url: "/LandMark/GetAllLandMark?_t=" + new Date(),
        // //     success: function (data) {
        // //         if (uButtonMode == 1) {
        // //             RealBimOcx.AddTagBegin();
        // //             $.each(data.result, function (i, item) {
        // //                 RealBimOcx.AddTag(item.dataExt, item.data, "", item.name, "70 140 150 120", 0xffffffff, 76, "", "", "70 71 150 90", 0x00000000, 76, "70 140 150 120", 0x80000000, 3, 0x00000000);
        // //             })
        // //             RealBimOcx.AddTagEnd();
        // //         } else {
        // //             RealBimOcx.DelAllTags();
        // //         }
        // //     }
        // // });
        // break;
        //
        // //添加标注
        // case "MARKER":
        //
        // clearOperate();
        //
        // RealBimOcx.CreateMarkerBegin();     //启用标注
        //
        //
        // break;
        //
        // //快照
        // case "CAPTURE":
        //
        // RealBimOcx.CreateSnapShootInMem(true, 0, 0, true, true);
        //
        // break;
        //
        // case "DISP_ISOLATE":
        // // RealBimOcx.SetIsolateSubElemIDBegin();
        // // if (uButtonMode === 1) {
        // //     RealBimOcx.SetIsolateSubElemID(selModel);
        // //     $.each(multiSelModel, function (i, item) {
        // //         RealBimOcx.SetIsolateSubElemID(item)
        // //     });
        // //     RealBimOcx.SetIsolateSubElemIDEnd();
        // // } else {
        // //     RealBimOcx.SetIsolateSubElemIDEnd();
        // //     if (hideComponents.length > 0) {
        // //         RealBimOcx.SetSubArrayClrInfo(hideComponents.toString(), 0, 255, 0);
        // //     }
        // // }
        // break;
        //
        // case "DISP_HIDE":
        // // if (uButtonMode === 1) {
        // //     RealBimOcx.SetHugeObjSubValidStateBegin();
        // //     RealBimOcx.SetHugeObjSubValidStateInfo(selModel, 0);
        // //     multiSelModel.push(selModel);
        // //     $.each(multiSelModel, function (i, item) {
        // //         RealBimOcx.SetHugeObjSubValidStateInfo(item, 0);
        // //     });
        // //     RealBimOcx.SetHugeObjSubValidStateEnd();
        // // } else {
        // //     RealBimOcx.SetHugeObjSubValidStateBegin();
        // //     RealBimOcx.SetHugeObjSubValidStateInfo(selModel, 1);
        // //     $.each(multiSelModel, function (i, item) {
        // //         RealBimOcx.SetHugeObjSubValidStateInfo(item, 1);
        // //     });
        // //     RealBimOcx.SetHugeObjSubValidStateEnd();
        // // }
        // break;
        //
        // }

    </script>

    <!--显示快照-->
    <script language="javascript" for="RealBimOcx" EVENT="SnapShootData(strPicData,picWidth,picHeight,strRenData)" type="text/javascript">
        // base64PicData = strPicData;
        // base64RenData = strRenData;
    </script>

    <script language="javascript"   for="RealBimOcx" EVENT="OnRealBimOcxInited()" type="text/javascript">
        // RealBimOcx.SwitchBIMSceneSimple("http://192.168.1.58:8008/default.aspx?dir=url_res02&path=","res_fengning_kw_03");

        //设置服务url
        /*RealBimOcx.SwitchBIMSceneSimple("F:\\RealEngine_11\\一些数据\\","res_fengning_kw_03");*/
        RealBimOcx.SwitchBIMSceneSimple("http://192.168.1.2:8008/default.aspx?dir=url_res02&path=","res_fengning_kw");
        RealBimOcx.SetSceVersionInfoExt(100, -1, 0, 2000000000);

        //设置字体
        RealBimOcx.CreateAGolFont("CustomFont01","微软雅黑",true,true,14,14,32,1.0,0*64,"");
        RealBimOcx.CreateAGolFont("CustomFont02","微软雅黑",true,true,12,12,8,1.0,0*64,"");


    </script>

    <!--初始化完成-->
    <script language="javascript"   for="RealBimOcx" EVENT="WorkCompleteNotification(CompleteEvent,retError)" type="text/javascript">

        //初始化的隐藏
        if(CompleteEvent == "LoadMainScene" && retError==0 ){
            RealBimOcx.SetAllHugeObjSubValidState(1);
            RealBimOcx.SetSceHugeObjVisible(true);
        }
    </script>
    <input id="FT1" type="button" value="FuncTest1" onclick="return FT1_onclick()" />
    <input id="FT2" type="button" value="FuncTest2" onclick="return FT2_onclick()" />
    <input id="FT3" type="button" value="FuncTest3" onclick="return FT3_onclick()" />
    {include file="../app/public/common_footer.html"}
</body>
</html>
