{include file="../app/public/common_header.html"}
<link rel="stylesheet" href="__WEBSITE__/main/index.css">
      <div data-options="region:'east',title:'管理信息',split:true" style="width:345px;">
            <div id="dd" class="easyui-tabs" style="width:100%;height:100%;border: 0">
                  <div title="属性" style="padding:20px;display:none;">
                        tab1
                  </div>
                  <div title="讨论" style="overflow:auto;padding:20px;display:none;">
                        tab2
                  </div>
                  <div title="附件" style="overflow:auto;padding:20px;display:none;">
                        tab3
                  </div>
                  <div title="二维码" style="overflow:auto;padding:20px;display:none;">
                        tab4
                  </div>
            </div>
      </div>
      <div data-options="region:'west',title:'管理视图',split:true" style="width:200px;"></div>
      <div data-options="region:'center',title:''" class="centent">
            <div class="easyui-layout" data-options="fit:true">
                  <div data-options="region:'center',title:''" style="padding:5px;">
                        <script language="javascript"  for="RealBimOcx" EVENT="OnCurSelModelChanged(strObjName, uObjSubID,   fObjSelX, fObjSelY, fObjSelZ,  fObjBVMinX,fObjBVMinY,fObjBVMinZ,  fObjBVMaxX,fObjBVMaxY,fObjBVMaxZ)" type="text/javascript">
                            RealBimOcx.ExitSubObjFlicker();
                            RealBimOcx.BatchAddSubClrInfoBegin();
                            RealBimOcx.AddSubClrPercent(uObjSubID,1,0x80ffa500);
                            RealBimOcx.BatchAddSubClrInfoEnd();
                        </script>
                        <object id="RealBimOcx" classid="CLSID:2CD7E1BE-10B8-4A1C-B908-4FB7D4FD4ABD"  width="100%" height="90%"></object>

                        <script language="javascript"   for="RealBimOcx" EVENT="OnRealBimOcxInited()" type="text/javascript">
                            // RealBimOcx.SwitchBIMSceneSimple("http://192.168.1.58:8008/default.aspx?dir=url_res02&path=","res_fengning_kw_03");

                            //设置服务url
                            RealBimOcx.SwitchBIMSceneSimple("F:\\","res_fengning_kw_03");
                            RealBimOcx.SetSceVersionInfoExt(100, -1, 0, 2000000000);

                            RealBimOcx.CreateAGolFont("CustomFont01","微软雅黑",true,true,14,14,32,1.0,0*64,"");
                            RealBimOcx.CreateAGolFont("CustomFont02","微软雅黑",true,true,12,12,8,1.0,0*64,"");
                        </script>

                        <script language="javascript"   for="RealBimOcx" EVENT="WorkCompleteNotification(CompleteEvent,retError)" type="text/javascript">
                            if(CompleteEvent == "LoadMainScene" && retError==0 ){
                                RealBimOcx.SetAllHugeObjSubValidState(1);
                                RealBimOcx.SetSceHugeObjVisible(true);
                            }
                            RealBimOcx.SetSuitableCam();
                        </script>

                        <script for="RealBimOcx" event="UIClicked(eType,uButtonMode)" language='javascript'>
                            function clearOperate() {
                                operateType = "";
                                RealBimOcx.AddAnchorEnd();
                                RealBimOcx.CreateMarkerEnd("", 0, 0, "", true);
                            };


                            switch (eType) {
                                case "ADD_ANCHOR":
                                    clearOperate();
                                    RealBimOcx.AddAnchorBegin(0);//构件锚点开始
                                    break; //添加锚点
                                case "DISP_ANCHOR":
                                    break; //显示锚点
                                case "DISP_TAG":
                                    break;
                                case "MARKER":
                                    clearOperate();
                                    RealBimOcx.CreateMarkerBegin();
                                    break;//添加标注

                                case "CAPTURE":  //快照
                                    clearOperate();
                                    RealBimOcx.CreateSnapShootInMem(true, 0, 0, true, true);
                                    break;
                                case "DISP_ISOLATE":
                                    break;
                                case "DISP_HIDE":
                                    break;

                            }
                        </script>
                        <script language="javascript" for="RealBimOcx" EVENT="SnapShootData(strPicData,picWidth,picHeight,strRenData)" type="text/javascript">
                            base64PicData = strPicData;
                            base64RenData = strRenData;
                            //添加快照
                            console.log('test');
                            addSnapshot(base64RenData);
                            $('.scenter a').click(function () {
                                RealBimOcx.ShowSnapshotOrMarkerInMem(base64RenData);
                            });
                        </script>
                  </div>
                  <div data-options="region:'south',title:'协同信息',split:true" style="height:250px;">
                        <div id="tt" class="easyui-tabs" style="width:100%;height:200px;border: 0">
                              <div title="标注" style="display:none;">
                                    <div class="swiper-container" id="tag">
                                          <div class="swiper-wrapper">
                                          </div>
                                          <!-- 如果需要导航按钮 -->
                                          <div class="swiper-button-prev tag-button-prev"></div>
                                          <div class="swiper-button-next tag-button-next"></div>
                                    </div>
                              </div>
                              <div title="快照" style="overflow:auto;display:none;">
                                    <div class="swiper-container" id="snapshot">
                                          <div class="swiper-wrapper">
                                          </div>
                                          <!-- 如果需要导航按钮 -->
                                          <div class="swiper-button-prev snapshot-button-prev"></div>
                                          <div class="swiper-button-next snapshot-button-next"></div>
                                    </div>
                              </div>
                        </div>
                  </div>
            </div>
      </div>
{include file="../app/public/common_footer.html"}
<script type="text/javascript">
      //标注图片滚动
      window.tagSwiper = new Swiper ('#tag', {
          nextButton: '.tag-button-next',
          prevButton: '.tag-button-prev',
          slidesPerView : 4,
          centeredSlides: false,
          paginationClickable: true,
          spaceBetween: 30,
      });
      //快照图片滚动
      window.snapshotSwiper = new Swiper ('#snapshot', {
          nextButton: '.snapshot-button-next',
          prevButton: '.snapshot-button-prev',
          slidesPerView : 4,
          centeredSlides: false,
          paginationClickable: true,
          spaceBetween: 30,
      });

      //添加快照
    window.addSnapshot = function (base64RenData) {
        var img =
            '<div class="swiper-slide swiperSlide">' +
                  '<img src="data:image/png;base64,'+ base64PicData +'" alt="">' +
                  '<div class="mask">' +
                        '<div class="right">' +
                              '<a href="javascript:;" onclick="imageSaveAs(base64PicData)" title="快照另存为">' +
                                    '<i class="fa fa-save"></i>' +
                              '</a>' +
                              '<a href="javascript:;" title="删除快照">' +
                                    '<i class="fa fa-close"></i>' +
                              '</a>' +
                        '</div>'+
                        '<div class="scenter">' +
                              '<a href="javascript:;" title="查看快照">' +
                                    '<i class="fa fa-search"></i>' +
                              '</a>' +
                        '</div>' +
                        '<div class="center">2018-04-20</div>'+
                  '</div>'+
            '</div>';
        snapshotSwiper.prependSlide(img);
        snapshotSwiper.updateSlidesSize();
    }
    $('.swiper-wrapper').on('mouseover mouseleave','div',function (e) {
        console.log(e);

        if(e.type == 'mouseover'){
            $(this).find('div.mask').stop(true,true).fadeIn(500);
        }else {
            $(this).find('div.mask').stop(true,true).fadeOut(500);
        }
    });

      $(document).keyup(function () {
          RealBimOcx.SubmitMarkerText('1111');
      });

      function imageSaveAs(imgURL) {
          var pagePop = window.open(imgURL, "", "width=1, height=1, top=5000, left=5000");
          for (; pagePop.document.readyState !== "complete";) {
              if (pagePop.document.readyState === "complete")
                  break;
          }
          pagePop.document.execCommand("SaveAs");
          pagePop.close();
      }


</script>
</body>
</html>